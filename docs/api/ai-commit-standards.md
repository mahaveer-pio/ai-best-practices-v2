# AI Commit Standards - PIO Manager Pro

<!-- [AI-Generated-Copilot] - AI commit documentation and standards -->

This document defines the standards and workflows for commits that contain AI-generated content.

## Overview

This guide establishes clear standards for identifying, documenting, and managing AI-assisted commits in the PIO Manager Pro codebase.

## AI Content Marking Standards

### Comment Format

All AI-generated content must be marked with standardized comments:

```typescript
// [AI-Generated-Copilot] - Brief description of what was generated
function calculatePIOScore(value: number, target: number): number {
  return Math.round((value / target) * 100)
}
```

### Supported AI Tools

Use these exact identifiers:

- `[AI-Generated-Copilot]` - GitHub Copilot
- `[AI-Generated-Claude]` - Anthropic Claude
- `[AI-Generated-ChatGPT]` - OpenAI ChatGPT
- `[AI-Generated-Gemini]` - Google Gemini
- `[AI-Generated-Other]` - Any other AI tool

### Comment Placement

```typescript
// ✅ CORRECT - Comment directly above the generated code
// [AI-Generated-Copilot] - User authentication hook
export function useAuth() {
  // implementation...
}

// ❌ INCORRECT - Comment inside the function
export function useAuth() {
  // [AI-Generated-Copilot] - User authentication hook
  // implementation...
}
```

## AI-Assisted Commit Message Format

### Automatic Detection

When the git hook detects AI-generated comments, it automatically transforms the commit message:

**Original Message:**

```
feat(dashboard): add PIO filter component
```

**Transformed Message:**

```
[AI-ASSISTED] feat(dashboard): add PIO filter component

Generated by: GitHub Copilot
Reviewed by: John Doe
Scope: Dashboard Components

Original commit message: feat(dashboard): add PIO filter component
AI-generated code found in: src/components/dashboard/kpi-filter.tsx
```

### Manual Format (if needed)

```
[AI-ASSISTED] type(scope): brief description

Generated by: [AI Tool Name]
Reviewed by: [Your Name]
Scope: [Component/Feature Area]

Detailed description of changes made...
```

## Commit Types

Use conventional commit types with AI-assisted prefix:

- `[AI-ASSISTED] feat:` - New features
- `[AI-ASSISTED] fix:` - Bug fixes
- `[AI-ASSISTED] docs:` - Documentation
- `[AI-ASSISTED] style:` - Code style changes
- `[AI-ASSISTED] refactor:` - Code refactoring
- `[AI-ASSISTED] test:` - Adding tests
- `[AI-ASSISTED] chore:` - Build/config changes

## AI-Restricted Files

### What are Restricted Files?

Files that AI tools should not modify without explicit human approval:

- Security and authentication code
- Environment configuration files
- Payment processing logic
- Critical infrastructure files
- Database migration scripts

### Configuration

Define restrictions in `.ai-restricted-files`:

```bash
# Security-sensitive files
**/security/**
**/auth/**
**/.env*
**/secrets/**

# Critical configuration
**/package.json
**/tsconfig.json
**/next.config.mjs

# Infrastructure
**/Dockerfile
**/docker-compose*.yml
**/.github/workflows/**
```

### Restriction Workflow

When AI touches a restricted file:

1. **Detection** - Pre-commit hook identifies violation
2. **Warning** - Clear warning displayed to user
3. **Choice** - User decides how to proceed:
   - Continue (with audit log)
   - Abort commit
   - Remove AI comments
4. **Logging** - Decision logged for audit trail

## Examples

### Basic AI-Assisted Commit

```bash
# File: src/utils/validation.ts
// [AI-Generated-Copilot] - Email validation utility
export function isValidEmail(email: string): boolean {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
}

# Git workflow:
git add src/utils/validation.ts
git commit -m "feat(utils): add email validation utility"

# Result: Automatic transformation to AI-assisted format
```

### AI-Assisted with Scope

```bash
# Multiple files with AI content
git add src/components/dashboard/kpi-chart.tsx src/hooks/use-kpi-data.ts
git commit -m "feat(dashboard): implement PIO chart visualization"

# Automatic transformation includes all AI-modified files
```

### Manual AI-Assisted Commit

```bash
git commit -m "[AI-ASSISTED] feat(api): add user authentication endpoint

Generated by: Claude
Reviewed by: Jane Smith
Scope: Authentication API

Implemented JWT-based authentication with password hashing
and session management for secure user login/logout."
```

## Audit and Compliance

### AI Commit Logging

All AI-assisted commits are logged to `.ai-commit-log`:

```
# AI Commit Log - PIO Manager Pro
# Format: Timestamp | Commit Hash | Title | AI Tool | Developer

2024-01-15 10:30:45 | abc123def | [AI-ASSISTED] feat(utils): add validation helpers | GitHub Copilot | john.doe
2024-01-15 14:22:18 | def456ghi | [AI-ASSISTED] docs(api): update endpoint documentation | Claude | jane.smith
```

### Restriction Override Logging

When users override AI restrictions, decisions are logged to `.ai-restriction-log`:

```
2024-01-15 09:15:30 - AI restriction override by john.doe
Files: src/auth/login.ts
Decision: User chose to continue despite AI restriction

2024-01-15 11:45:20 - AI restriction override by jane.smith
Files: .env.production, config/database.json
Decision: User chose to continue despite AI restriction
```

### Monitoring Commands

```bash
# View recent AI commits
tail -20 .ai-commit-log

# Count AI commits by tool
grep -c "Copilot" .ai-commit-log
grep -c "Claude" .ai-commit-log

# Check restriction overrides
tail -10 .ai-restriction-log

# Find AI commits by developer
grep "john.doe" .ai-commit-log
```

## Best Practices

### DO's

- ✅ Always add AI comments for substantial AI-generated code
- ✅ Review all AI-generated code before committing
- ✅ Use descriptive comments explaining what AI generated
- ✅ Test AI-generated code thoroughly
- ✅ Keep AI comments concise but informative

### DON'Ts

- ❌ Don't commit AI-generated code without proper comments
- ❌ Don't modify AI comments after they're added
- ❌ Don't use generic or incorrect AI tool names
- ❌ Don't bypass restrictions without good reason
- ❌ Don't commit untested AI-generated code

### Code Review Guidelines

When reviewing AI-assisted commits:

1. **Verify AI comments** are present and accurate
2. **Test functionality** of AI-generated code
3. **Check code quality** and project standards compliance
4. **Validate integration** with existing codebase
5. **Ensure security** considerations are addressed

## Tool Integration

### VS Code

The system works seamlessly with:

- VS Code Git integration
- GitHub Copilot extension
- GitLens extension
- Terminal commits

### Command Line

Compatible with all Git CLI operations:

- `git commit` - Standard commits
- `git commit -m` - Message commits
- `git commit --amend` - Amending commits

### Git Clients

Works with popular Git clients:

- SourceTree
- GitKraken
- Tower
- Fork

## Troubleshooting

### Common Issues

**AI comments not detected:**

- Verify comment format matches exactly
- Check file is staged for commit
- Ensure Git hooks are executable

**Commit message not transformed:**

- Confirm AI comments exist in staged files
- Check Git hooks are running
- Verify hook permissions

**Restriction not triggering:**

- Check `.ai-restricted-files` exists
- Verify file patterns are correct
- Ensure AI comments are present

### Debug Mode

Enable debug output by temporarily editing hooks:

```bash
# Add to pre-commit hook
echo "DEBUG: Testing file $file against pattern $pattern" >&2
```

### Emergency Bypass

Only use in genuine emergencies:

```bash
# Bypass all hooks
git commit --no-verify -m "emergency: critical fix"

# Bypass specific restrictions temporarily
mv .ai-restricted-files .ai-restricted-files.backup
# Make commit
mv .ai-restricted-files.backup .ai-restricted-files
```

## Implementation Details

### Hook Workflow

1. **Pre-commit** (`pre-commit` hook):
   - Scan staged files for AI comments
   - Check restricted file patterns
   - Prompt user if violations found
   - Run lint-staged if no issues

2. **Commit Message** (`commit-msg` hook):
   - Detect AI comments in staged files
   - Transform commit message automatically
   - Validate AI-assisted message format
   - Log AI commits for audit

3. **Pre-push** (`pre-push` hook):
   - Run TypeScript type checking
   - Execute test suite
   - Verify production build

### AI Detection Patterns

The system scans for these comment patterns:

```bash
# JavaScript/TypeScript/Java/C++
"//\s*\[AI-Generated-[A-Za-z]+\]"

# Python/Shell/YAML/Ruby
"#\s*\[AI-Generated-[A-Za-z]+\]"

# CSS/SQL block comments
"/\*\s*\[AI-Generated-[A-Za-z]+\]"

# HTML/XML/Markdown
"<!--\s*\[AI-Generated-[A-Za-z]+\]"

# SQL/Lua/Haskell
"--\s*\[AI-Generated-[A-Za-z]+\]"
```

This comprehensive system ensures full traceability and compliance for AI-assisted development while maintaining workflow efficiency.
